<!doctype html>
<html>

<head>
    <!-- Jquery   -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <!--Materialize-->
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title> AWLI - Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="text/javascript">
    function onProfileData(payload) {

        $('#full-text').val(JSON.stringify(payload));
        $('#first_name').val(payload.firstName);
        $('#last_name').val(payload.lastName);
        $('#title').val(payload.headline);
        $.each(payload.positions, function(key, value) {
            $('#positions').val($('#positions').val() + "\n" + value.title);
            // console.log(value.title);
        })
        $('#email').val(payload.emailAddress);
        $('#phone').val(payload.phoneNumber);

        M.toast({ html: "Form pre-filled" })

    };

    $(document).ready(function() {

        // Loads the widget when the load button is clicked
        $("#load").click(function() {
            key = $("#key").val();
            $('#awli-widget').attr('data-api-key', key);
            integrationContext = $("#integContext").val();
            $('#awli-widget').attr('data-integration-context', integrationContext);
            console.log(key);
            console.log($('#awli-widget').attr('data-api-key'));

            // This event is triggered to reload the widget. 
            // This may be used in your app to reload the widget if needed
            var event = new Event('awli-widget-load');
            window.dispatchEvent(event);
        });

        // Redirects to the confirm page when application is submitted.
        $("#submit-application").click(function() {
            key = $("#key").val();
            integrationContext = $("#integContext").val();
            window.location.replace("/apply-confirm.html?key=" + key + "&ic=" + integrationContext);
        });

    });
    </script>
</head>

<body>
    <nav>
        <div class=" light-blue darken-2 nav-wrapper row">
            <div class="col s12">
                <a href="#!" class="brand-logo">Your Application Name</a>
                <ul class="right hide-on-med-and-down">
                    <li>
                        <a href="//developer.linkedin.com/docs/lts/apply-with-linkedin/d2p-self-serve">Documentation Home For ATS</a>
                    </li>
                    <li>
                        <a href="//developer.linkedin.com/docs/lts/apply-with-linkedin/d2c-self-serve">Documentation Home For non-ATS Apps</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container center white-text row">
        <div class="col s12 m12">
            <h2 class="page-title"> <span class="amber-text"></span><span class="light-blue-text">Apply With LinkedIn - Developer Demo</span></h2>
        </div>
    </div>
    <div class="">
        <div class="">
            <div class="container" id="form">
                <div class="row grey lighten-3 blue-grey-text text-darken-4">
                    <div class="col s12">
                        <p> <i class="small material-icons">announcement</i> The API Key and Integration Context values are generated by using the Provisioning API and Customer Config Widget if you have an ATS. Once obtained you mays store these values and retrieve them from your datastore. For the purposes of this demo you can enter the values here to see what the widget looks like.
                        </p>
                        <p>
                          For the API key you input here, make sure that the domain URL being used here is whitelisted.
                        </p>
                    </div>
                </div>
                <label>Api Key</label>
                <input type="text" id="key" name="key" value="">
                <label>Integration Context</label>
                <input type="text" id="integContext" name="integrationContext" value="">
                <button class="btn waves-effect waves-light" id="load" type="submit" name="action">Load
                    <i class="material-icons right">data_usage</i>
                </button>
            </div>
            <div class="section"></div>
            <div class="divider"></div>

            <div class="grey lighten-4" id="job-application">
                <div class="container">
                    <div class="section"></div>
                    <h4 class="blue-grey-text text-darken-3">Director of Product Management [Sample]</h4>
                    <h6>SAN FRANCISCO   ||   PRODUCT  ||   FULL-TIME</h6>
                    <div class="section"></div>
                    <div>
                        <p class="flow-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    </div>

                    <!-- Widget Embed Code -->
                    <div class="" name="widget-holder" style="width: 210px;height: 100px">
                        <script type="text/javascript" src="https://www.linkedin.com/mjobs/awli/awliWidget">
                        </script>
                        <script id="awli-widget" type="IN/AwliWidget" data-company-job-code="testJob123" data-integration-context="" data-mode="BUTTON_DATA" data-callback-method="onProfileData" data-api-key="" data-allow-sign-in="true" data-size="large">
                        </script>
                    </div>

                    <div class="section"></div>
                    <!-- INPUT FORM -->
                    <div class="row">
                        <form class="col s12">
                            <div class="row">
                                <div class="input-field col s6">
                                    <input placeholder="" id="first_name" type="text" class="validate">
                                    <label for="first_name">First Name</label>
                                </div>
                                <div class="input-field col s6">
                                    <input placeholder="" id="last_name" type="text" class="validate">
                                    <label for="last_name">Last Name</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input placeholder="" id="title" type="text" class="validate">
                                    <label for="title">Title</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input placeholder="" id="location" type="text" class="validate">
                                    <label for="location">Location</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea placeholder="" id="positions" type="text" class="materialize-textarea"></textarea>
                                    <label for="positions">positions</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input placeholder="" id="email" type="text" class="validate">
                                    <label for="email">Email</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input placeholder="" id="phone" type="text" class="validate">
                                    <label for="phone">Phone</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class=" col s12">
                                    <label for="full-text">Full JSON response</label>
                                    <textarea class="materialize-textarea" id="full-text"></textarea>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <a id="submit-application" class="waves-effect waves-light btn">Submit</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <footer class="page-footer light-blue">
            <div class="container">
                <div class="row">
                    <div class="col l6 s12">
                        <h5 class="white-text">LinkedIn</h5>
                        <p class="grey-text text-lighten-4">This is a demo of Apply With LinkedIn.</p>
                    </div>
                    <div class="col l4 offset-l2 s12">
                        <h5 class="white-text">Links</h5>
                        <ul>
                            <li><a class="grey-text text-lighten-3" href="">AWLI 2.0</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-copyright">
                <div class="container">© 2018 Copyright Text </div>
            </div>
        </footer>
    </div>
    <!-- Compiled and minified JavaScript for Materialize -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
</body>

</html>